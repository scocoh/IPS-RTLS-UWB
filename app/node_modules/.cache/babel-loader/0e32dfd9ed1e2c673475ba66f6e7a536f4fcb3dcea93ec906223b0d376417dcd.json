{"ast":null,"code":"var _jsxFileName = \"/home/parcoadmin/parco_fastapi/app/src/components/MapZoneBuilder.js\",\n  _s = $RefreshSig$();\n// /home/parcoadmin/parco_fastapi/app/src/components/MapZoneBuilder.js\nimport React, { useEffect, useRef, useState, memo } from \"react\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport \"leaflet-draw/dist/leaflet.draw.css\";\nimport \"leaflet-draw\";\nimport \"./Map.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MapZoneBuilder = /*#__PURE__*/_s(/*#__PURE__*/memo(_c = _s(({\n  zoneId,\n  onDrawComplete,\n  triggerColor,\n  useLeaflet,\n  drawnItems,\n  parentZoneVertices\n}) => {\n  _s();\n  const mapRef = useRef(null);\n  const mapInstance = useRef(null);\n  const canvasRef = useRef(null);\n  const [mapData, setMapData] = useState(null);\n  const [error, setError] = useState(null);\n  const isInitialized = useRef(false);\n  const points = useRef([]);\n  const isDrawing = useRef(false);\n  const ctxRef = useRef(null);\n  const imageRef = useRef(null);\n  const parentLayer = useRef(null); // For Leaflet mode\n  const canvasBounds = useRef({\n    x: 0,\n    y: 0,\n    width: 800,\n    height: 600\n  }); // Adjusted bounds\n\n  // Fetch map data\n  useEffect(() => {\n    if (zoneId) {\n      const fetchMapData = async () => {\n        try {\n          const response = await fetch(`/zonebuilder/get_map_data/${zoneId}`);\n          if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);\n          const data = await response.json();\n          console.log(\"✅ Fetched map data:\", data);\n          setMapData(data);\n          setError(null);\n        } catch (error) {\n          console.error(\"❌ Error fetching map data:\", error);\n          setError(`Error fetching map data: ${error.message}`);\n        }\n      };\n      fetchMapData();\n    } else {\n      setMapData(null);\n      setError(null);\n    }\n  }, [zoneId]);\n\n  // Canvas rendering\n  useEffect(() => {\n    if (!useLeaflet && mapData && canvasRef.current && !isInitialized.current) {\n      console.log(\"🖌 Initializing Canvas rendering with mapData:\", mapData);\n      const canvas = canvasRef.current;\n      const ctx = canvas.getContext(\"2d\");\n      if (!ctx) {\n        console.error(\"❌ Canvas context is null\");\n        return;\n      }\n      ctxRef.current = ctx;\n      canvas.width = 800;\n      canvas.height = 600;\n      const img = new Image();\n      img.crossOrigin = \"anonymous\";\n      img.src = mapData.imageUrl;\n      imageRef.current = img;\n      img.onload = () => {\n        console.log(\"✅ Canvas: Map image loaded:\", mapData.imageUrl, \"Dimensions:\", img.width, \"x\", img.height);\n        // Calculate adjusted bounds to maintain aspect ratio\n        const mapWidth = mapData.bounds[1][1] - mapData.bounds[0][1]; // max_x - min_x\n        const mapHeight = mapData.bounds[1][0] - mapData.bounds[0][0]; // max_y - min_y\n        const mapAspect = mapWidth / mapHeight;\n        const canvasAspect = canvas.width / canvas.height;\n        let drawWidth = canvas.width;\n        let drawHeight = canvas.height;\n        let offsetX = 0;\n        let offsetY = 0;\n        if (mapAspect > canvasAspect) {\n          // Map is wider than canvas: fit width, adjust height\n          drawHeight = canvas.width / mapAspect;\n          offsetY = (canvas.height - drawHeight) / 2;\n        } else {\n          // Map is taller than canvas: fit height, adjust width\n          drawWidth = canvas.height * mapAspect;\n          offsetX = (canvas.width - drawWidth) / 2;\n        }\n        canvasBounds.current = {\n          x: offsetX,\n          y: offsetY,\n          width: drawWidth,\n          height: drawHeight\n        };\n        console.log(\"🖌 Canvas adjusted bounds:\", canvasBounds.current);\n        drawCanvas();\n      };\n      img.onerror = () => {\n        console.error(\"❌ Canvas: Failed to load map image:\", mapData.imageUrl);\n        setError(\"Failed to load map image.\");\n      };\n      const handleMouseDown = e => {\n        if (e.button !== 0) return;\n        isDrawing.current = true;\n        const rect = canvas.getBoundingClientRect();\n        if (!rect) {\n          console.error(\"❌ Canvas bounding rect is null\");\n          return;\n        }\n        const scaleX = canvasBounds.current.width / (mapData.bounds[1][1] - mapData.bounds[0][1]);\n        const scaleY = canvasBounds.current.height / (mapData.bounds[1][0] - mapData.bounds[0][0]);\n        const x = mapData.bounds[0][1] + (e.clientX - rect.left - canvasBounds.current.x) / scaleX;\n        const y = mapData.bounds[0][0] + (e.clientY - rect.top - canvasBounds.current.y) / scaleY; // Adjusted Y-axis\n\n        points.current.push({\n          x,\n          y\n        });\n        console.log(\"🖱 Canvas click (feet):\", {\n          x,\n          y\n        });\n        drawCanvas();\n        onDrawComplete(points.current);\n      };\n      const drawCanvas = () => {\n        if (!ctxRef.current || !imageRef.current) {\n          console.error(\"❌ Canvas context or image ref is null\");\n          return;\n        }\n        const ctx = ctxRef.current;\n        const img = imageRef.current;\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.drawImage(img, canvasBounds.current.x, canvasBounds.current.y, canvasBounds.current.width, canvasBounds.current.height);\n\n        // Draw parent zone vertices as a light blue shape (non-editable)\n        if (parentZoneVertices && parentZoneVertices.length > 0) {\n          console.log(\"📌 Rendering parent zone vertices in Canvas:\", parentZoneVertices);\n          ctx.beginPath();\n          let firstPoint = true;\n          let hasValidPoints = false;\n          parentZoneVertices.forEach((vertex, index) => {\n            const x = vertex.n_x !== undefined ? vertex.n_x : vertex.x || 0;\n            const y = vertex.n_y !== undefined ? vertex.n_y : vertex.y || 0;\n            if (isNaN(x) || isNaN(y)) {\n              console.warn(`⚠️ Invalid vertex at index ${index}: x=${x}, y=${y}`, vertex);\n              return;\n            }\n            const canvasX = canvasBounds.current.x + (x - mapData.bounds[0][1]) * (canvasBounds.current.width / (mapData.bounds[1][1] - mapData.bounds[0][1]));\n            const canvasY = canvasBounds.current.y + (y - mapData.bounds[0][0]) * (canvasBounds.current.height / (mapData.bounds[1][0] - mapData.bounds[0][0]));\n            if (firstPoint) {\n              ctx.moveTo(canvasX, canvasY);\n              firstPoint = false;\n              hasValidPoints = true;\n            } else {\n              ctx.lineTo(canvasX, canvasY);\n            }\n          });\n          if (hasValidPoints) {\n            ctx.closePath();\n            ctx.strokeStyle = \"lightblue\";\n            ctx.lineWidth = 2;\n            ctx.stroke();\n            ctx.fillStyle = \"rgba(173, 216, 230, 0.3)\"; // Light blue fill with transparency\n            ctx.fill();\n            console.log(\"✅ Rendered parent zone shape in Canvas\");\n          } else {\n            console.warn(\"⚠️ No valid points to render parent zone in Canvas\");\n          }\n        } else {\n          console.log(\"ℹ️ No parent zone vertices to render in Canvas\");\n        }\n\n        // Draw current editable polygon\n        if (points.current.length === 0) return;\n        ctx.beginPath();\n        points.current.forEach((point, index) => {\n          const x = canvasBounds.current.x + (point.x - mapData.bounds[0][1]) * (canvasBounds.current.width / (mapData.bounds[1][1] - mapData.bounds[0][1]));\n          const y = canvasBounds.current.y + (point.y - mapData.bounds[0][0]) * (canvasBounds.current.height / (mapData.bounds[1][0] - mapData.bounds[0][0]));\n          if (index === 0) ctx.moveTo(x, y);else ctx.lineTo(x, y);\n          ctx.fillStyle = \"blue\";\n          ctx.fillRect(x - 2, y - 2, 4, 4);\n        });\n        ctx.closePath();\n        ctx.strokeStyle = triggerColor || \"red\";\n        ctx.stroke();\n      };\n      canvas.addEventListener(\"mousedown\", handleMouseDown);\n      isInitialized.current = true;\n      return () => {\n        canvas.removeEventListener(\"mousedown\", handleMouseDown);\n        isInitialized.current = false;\n      };\n    }\n  }, [mapData, useLeaflet, onDrawComplete, triggerColor, parentZoneVertices]);\n\n  // Leaflet rendering\n  useEffect(() => {\n    if (useLeaflet && mapData && mapRef.current && !mapInstance.current) {\n      console.log(\"🗺 Initializing Leaflet with mapData:\", mapData);\n      mapInstance.current = L.map(mapRef.current, {\n        crs: L.CRS.Simple\n      }).fitBounds(mapData.bounds);\n      console.log(\"🗺 Leaflet fitBounds applied:\", mapData.bounds);\n      L.imageOverlay(mapData.imageUrl, mapData.bounds).addTo(mapInstance.current);\n      mapInstance.current.addLayer(drawnItems);\n      const drawControl = new L.Control.Draw({\n        edit: {\n          featureGroup: drawnItems\n        },\n        draw: {\n          polygon: {\n            shapeOptions: {\n              color: triggerColor || \"red\",\n              weight: 2\n            }\n          },\n          rectangle: false,\n          circle: false,\n          polyline: false,\n          marker: false\n        }\n      });\n      mapInstance.current.addControl(drawControl);\n      mapInstance.current.on(L.Draw.Event.CREATED, event => {\n        const layer = event.layer;\n        drawnItems.addLayer(layer);\n        const coords = layer.getLatLngs()[0].map((point, index) => ({\n          n_x: point.lng,\n          n_y: point.lat,\n          n_z: 0,\n          n_ord: index + 1\n        }));\n        console.log(\"🖌 Leaflet drawn coordinates (feet):\", coords);\n        onDrawComplete(coords);\n      });\n      console.log(\"✅ Leaflet map initialized with bounds:\", mapData.bounds);\n    }\n\n    // Draw parent zone vertices as a non-editable light blue shape\n    if (useLeaflet && mapInstance.current) {\n      if (parentLayer.current) {\n        mapInstance.current.removeLayer(parentLayer.current);\n        parentLayer.current = null;\n      }\n      if (parentZoneVertices && parentZoneVertices.length > 0) {\n        console.log(\"📌 Rendering parent zone vertices in Leaflet:\", parentZoneVertices);\n        const latLngs = parentZoneVertices.map(vertex => {\n          const x = vertex.n_x !== undefined ? vertex.n_x : vertex.x || 0;\n          const y = vertex.n_y !== undefined ? vertex.n_y : vertex.y || 0;\n          if (isNaN(x) || isNaN(y)) {\n            console.warn(`⚠️ Invalid vertex in parentZoneVertices: x=${x}, y=${y}`, vertex);\n            return null;\n          }\n          return [y, x]; // [lat, lng] for Leaflet\n        }).filter(coord => coord !== null);\n        if (latLngs.length > 0) {\n          parentLayer.current = L.polygon(latLngs, {\n            color: \"lightblue\",\n            weight: 2,\n            fillColor: \"lightblue\",\n            fillOpacity: 0.3,\n            interactive: false\n          }).addTo(mapInstance.current);\n          console.log(\"✅ Rendered parent zone shape in Leaflet:\", latLngs);\n        } else {\n          console.warn(\"⚠️ No valid latLngs to render parent zone in Leaflet\");\n        }\n      } else {\n        console.log(\"ℹ️ No parent zone vertices to render in Leaflet\");\n      }\n    }\n\n    // Cleanup\n    return () => {\n      if (mapInstance.current) {\n        mapInstance.current.remove();\n        mapInstance.current = null;\n        console.log(\"🗺 Leaflet map cleaned up\");\n      }\n    };\n  }, [mapData, useLeaflet, onDrawComplete, triggerColor, drawnItems, parentZoneVertices]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        color: \"red\",\n        marginBottom: \"10px\"\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 23\n    }, this), useLeaflet ? /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapRef,\n      style: {\n        height: \"600px\",\n        width: \"800px\",\n        border: \"2px solid black\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      id: \"map\",\n      style: {\n        border: \"2px solid black\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 281,\n    columnNumber: 9\n  }, this);\n}, \"nl5xAUo7fyX2KlMCbZrXoVolh6I=\")), \"nl5xAUo7fyX2KlMCbZrXoVolh6I=\");\n_c2 = MapZoneBuilder;\nexport default MapZoneBuilder;\nvar _c, _c2;\n$RefreshReg$(_c, \"MapZoneBuilder$memo\");\n$RefreshReg$(_c2, \"MapZoneBuilder\");","map":{"version":3,"names":["React","useEffect","useRef","useState","memo","L","jsxDEV","_jsxDEV","MapZoneBuilder","_s","_c","zoneId","onDrawComplete","triggerColor","useLeaflet","drawnItems","parentZoneVertices","mapRef","mapInstance","canvasRef","mapData","setMapData","error","setError","isInitialized","points","isDrawing","ctxRef","imageRef","parentLayer","canvasBounds","x","y","width","height","fetchMapData","response","fetch","ok","Error","status","data","json","console","log","message","current","canvas","ctx","getContext","img","Image","crossOrigin","src","imageUrl","onload","mapWidth","bounds","mapHeight","mapAspect","canvasAspect","drawWidth","drawHeight","offsetX","offsetY","drawCanvas","onerror","handleMouseDown","e","button","rect","getBoundingClientRect","scaleX","scaleY","clientX","left","clientY","top","push","clearRect","drawImage","length","beginPath","firstPoint","hasValidPoints","forEach","vertex","index","n_x","undefined","n_y","isNaN","warn","canvasX","canvasY","moveTo","lineTo","closePath","strokeStyle","lineWidth","stroke","fillStyle","fill","point","fillRect","addEventListener","removeEventListener","map","crs","CRS","Simple","fitBounds","imageOverlay","addTo","addLayer","drawControl","Control","Draw","edit","featureGroup","draw","polygon","shapeOptions","color","weight","rectangle","circle","polyline","marker","addControl","on","Event","CREATED","event","layer","coords","getLatLngs","lng","lat","n_z","n_ord","removeLayer","latLngs","filter","coord","fillColor","fillOpacity","interactive","remove","children","style","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","ref","border","id","_c2","$RefreshReg$"],"sources":["/home/parcoadmin/parco_fastapi/app/src/components/MapZoneBuilder.js"],"sourcesContent":["// /home/parcoadmin/parco_fastapi/app/src/components/MapZoneBuilder.js\nimport React, { useEffect, useRef, useState, memo } from \"react\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\nimport \"leaflet-draw/dist/leaflet.draw.css\";\nimport \"leaflet-draw\";\nimport \"./Map.css\";\n\nconst MapZoneBuilder = memo(({ zoneId, onDrawComplete, triggerColor, useLeaflet, drawnItems, parentZoneVertices }) => {\n    const mapRef = useRef(null);\n    const mapInstance = useRef(null);\n    const canvasRef = useRef(null);\n    const [mapData, setMapData] = useState(null);\n    const [error, setError] = useState(null);\n    const isInitialized = useRef(false);\n    const points = useRef([]);\n    const isDrawing = useRef(false);\n    const ctxRef = useRef(null);\n    const imageRef = useRef(null);\n    const parentLayer = useRef(null); // For Leaflet mode\n    const canvasBounds = useRef({ x: 0, y: 0, width: 800, height: 600 }); // Adjusted bounds\n\n    // Fetch map data\n    useEffect(() => {\n        if (zoneId) {\n            const fetchMapData = async () => {\n                try {\n                    const response = await fetch(`/zonebuilder/get_map_data/${zoneId}`);\n                    if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);\n                    const data = await response.json();\n                    console.log(\"✅ Fetched map data:\", data);\n                    setMapData(data);\n                    setError(null);\n                } catch (error) {\n                    console.error(\"❌ Error fetching map data:\", error);\n                    setError(`Error fetching map data: ${error.message}`);\n                }\n            };\n            fetchMapData();\n        } else {\n            setMapData(null);\n            setError(null);\n        }\n    }, [zoneId]);\n\n    // Canvas rendering\n    useEffect(() => {\n        if (!useLeaflet && mapData && canvasRef.current && !isInitialized.current) {\n            console.log(\"🖌 Initializing Canvas rendering with mapData:\", mapData);\n            const canvas = canvasRef.current;\n            const ctx = canvas.getContext(\"2d\");\n            if (!ctx) {\n                console.error(\"❌ Canvas context is null\");\n                return;\n            }\n            ctxRef.current = ctx;\n\n            canvas.width = 800;\n            canvas.height = 600;\n\n            const img = new Image();\n            img.crossOrigin = \"anonymous\";\n            img.src = mapData.imageUrl;\n            imageRef.current = img;\n\n            img.onload = () => {\n                console.log(\"✅ Canvas: Map image loaded:\", mapData.imageUrl, \"Dimensions:\", img.width, \"x\", img.height);\n                // Calculate adjusted bounds to maintain aspect ratio\n                const mapWidth = mapData.bounds[1][1] - mapData.bounds[0][1]; // max_x - min_x\n                const mapHeight = mapData.bounds[1][0] - mapData.bounds[0][0]; // max_y - min_y\n                const mapAspect = mapWidth / mapHeight;\n                const canvasAspect = canvas.width / canvas.height;\n\n                let drawWidth = canvas.width;\n                let drawHeight = canvas.height;\n                let offsetX = 0;\n                let offsetY = 0;\n\n                if (mapAspect > canvasAspect) {\n                    // Map is wider than canvas: fit width, adjust height\n                    drawHeight = canvas.width / mapAspect;\n                    offsetY = (canvas.height - drawHeight) / 2;\n                } else {\n                    // Map is taller than canvas: fit height, adjust width\n                    drawWidth = canvas.height * mapAspect;\n                    offsetX = (canvas.width - drawWidth) / 2;\n                }\n\n                canvasBounds.current = { x: offsetX, y: offsetY, width: drawWidth, height: drawHeight };\n                console.log(\"🖌 Canvas adjusted bounds:\", canvasBounds.current);\n\n                drawCanvas();\n            };\n\n            img.onerror = () => {\n                console.error(\"❌ Canvas: Failed to load map image:\", mapData.imageUrl);\n                setError(\"Failed to load map image.\");\n            };\n\n            const handleMouseDown = (e) => {\n                if (e.button !== 0) return;\n                isDrawing.current = true;\n                const rect = canvas.getBoundingClientRect();\n                if (!rect) {\n                    console.error(\"❌ Canvas bounding rect is null\");\n                    return;\n                }\n                const scaleX = canvasBounds.current.width / (mapData.bounds[1][1] - mapData.bounds[0][1]);\n                const scaleY = canvasBounds.current.height / (mapData.bounds[1][0] - mapData.bounds[0][0]);\n\n                const x = mapData.bounds[0][1] + ((e.clientX - rect.left - canvasBounds.current.x) / scaleX);\n                const y = mapData.bounds[0][0] + ((e.clientY - rect.top - canvasBounds.current.y) / scaleY); // Adjusted Y-axis\n\n                points.current.push({ x, y });\n                console.log(\"🖱 Canvas click (feet):\", { x, y });\n\n                drawCanvas();\n                onDrawComplete(points.current);\n            };\n\n            const drawCanvas = () => {\n                if (!ctxRef.current || !imageRef.current) {\n                    console.error(\"❌ Canvas context or image ref is null\");\n                    return;\n                }\n                const ctx = ctxRef.current;\n                const img = imageRef.current;\n\n                ctx.clearRect(0, 0, canvas.width, canvas.height);\n                ctx.drawImage(img, canvasBounds.current.x, canvasBounds.current.y, canvasBounds.current.width, canvasBounds.current.height);\n\n                // Draw parent zone vertices as a light blue shape (non-editable)\n                if (parentZoneVertices && parentZoneVertices.length > 0) {\n                    console.log(\"📌 Rendering parent zone vertices in Canvas:\", parentZoneVertices);\n                    ctx.beginPath();\n                    let firstPoint = true;\n                    let hasValidPoints = false;\n                    parentZoneVertices.forEach((vertex, index) => {\n                        const x = vertex.n_x !== undefined ? vertex.n_x : (vertex.x || 0);\n                        const y = vertex.n_y !== undefined ? vertex.n_y : (vertex.y || 0);\n                        if (isNaN(x) || isNaN(y)) {\n                            console.warn(`⚠️ Invalid vertex at index ${index}: x=${x}, y=${y}`, vertex);\n                            return;\n                        }\n                        const canvasX = canvasBounds.current.x + (x - mapData.bounds[0][1]) * (canvasBounds.current.width / (mapData.bounds[1][1] - mapData.bounds[0][1]));\n                        const canvasY = canvasBounds.current.y + (y - mapData.bounds[0][0]) * (canvasBounds.current.height / (mapData.bounds[1][0] - mapData.bounds[0][0]));\n                        if (firstPoint) {\n                            ctx.moveTo(canvasX, canvasY);\n                            firstPoint = false;\n                            hasValidPoints = true;\n                        } else {\n                            ctx.lineTo(canvasX, canvasY);\n                        }\n                    });\n                    if (hasValidPoints) {\n                        ctx.closePath();\n                        ctx.strokeStyle = \"lightblue\";\n                        ctx.lineWidth = 2;\n                        ctx.stroke();\n                        ctx.fillStyle = \"rgba(173, 216, 230, 0.3)\"; // Light blue fill with transparency\n                        ctx.fill();\n                        console.log(\"✅ Rendered parent zone shape in Canvas\");\n                    } else {\n                        console.warn(\"⚠️ No valid points to render parent zone in Canvas\");\n                    }\n                } else {\n                    console.log(\"ℹ️ No parent zone vertices to render in Canvas\");\n                }\n\n                // Draw current editable polygon\n                if (points.current.length === 0) return;\n                ctx.beginPath();\n                points.current.forEach((point, index) => {\n                    const x = canvasBounds.current.x + (point.x - mapData.bounds[0][1]) * (canvasBounds.current.width / (mapData.bounds[1][1] - mapData.bounds[0][1]));\n                    const y = canvasBounds.current.y + (point.y - mapData.bounds[0][0]) * (canvasBounds.current.height / (mapData.bounds[1][0] - mapData.bounds[0][0]));\n                    if (index === 0) ctx.moveTo(x, y);\n                    else ctx.lineTo(x, y);\n\n                    ctx.fillStyle = \"blue\";\n                    ctx.fillRect(x - 2, y - 2, 4, 4);\n                });\n                ctx.closePath();\n                ctx.strokeStyle = triggerColor || \"red\";\n                ctx.stroke();\n            };\n\n            canvas.addEventListener(\"mousedown\", handleMouseDown);\n            isInitialized.current = true;\n            return () => {\n                canvas.removeEventListener(\"mousedown\", handleMouseDown);\n                isInitialized.current = false;\n            };\n        }\n    }, [mapData, useLeaflet, onDrawComplete, triggerColor, parentZoneVertices]);\n\n    // Leaflet rendering\n    useEffect(() => {\n        if (useLeaflet && mapData && mapRef.current && !mapInstance.current) {\n            console.log(\"🗺 Initializing Leaflet with mapData:\", mapData);\n            mapInstance.current = L.map(mapRef.current, { crs: L.CRS.Simple }).fitBounds(mapData.bounds);\n            console.log(\"🗺 Leaflet fitBounds applied:\", mapData.bounds);\n            L.imageOverlay(mapData.imageUrl, mapData.bounds).addTo(mapInstance.current);\n            mapInstance.current.addLayer(drawnItems);\n\n            const drawControl = new L.Control.Draw({\n                edit: { featureGroup: drawnItems },\n                draw: {\n                    polygon: { shapeOptions: { color: triggerColor || \"red\", weight: 2 } },\n                    rectangle: false,\n                    circle: false,\n                    polyline: false,\n                    marker: false,\n                },\n            });\n            mapInstance.current.addControl(drawControl);\n\n            mapInstance.current.on(L.Draw.Event.CREATED, (event) => {\n                const layer = event.layer;\n                drawnItems.addLayer(layer);\n                const coords = layer.getLatLngs()[0].map((point, index) => ({\n                    n_x: point.lng,\n                    n_y: point.lat,\n                    n_z: 0,\n                    n_ord: index + 1\n                }));\n                console.log(\"🖌 Leaflet drawn coordinates (feet):\", coords);\n                onDrawComplete(coords);\n            });\n\n            console.log(\"✅ Leaflet map initialized with bounds:\", mapData.bounds);\n        }\n\n        // Draw parent zone vertices as a non-editable light blue shape\n        if (useLeaflet && mapInstance.current) {\n            if (parentLayer.current) {\n                mapInstance.current.removeLayer(parentLayer.current);\n                parentLayer.current = null;\n            }\n\n            if (parentZoneVertices && parentZoneVertices.length > 0) {\n                console.log(\"📌 Rendering parent zone vertices in Leaflet:\", parentZoneVertices);\n                const latLngs = parentZoneVertices\n                    .map(vertex => {\n                        const x = vertex.n_x !== undefined ? vertex.n_x : (vertex.x || 0);\n                        const y = vertex.n_y !== undefined ? vertex.n_y : (vertex.y || 0);\n                        if (isNaN(x) || isNaN(y)) {\n                            console.warn(`⚠️ Invalid vertex in parentZoneVertices: x=${x}, y=${y}`, vertex);\n                            return null;\n                        }\n                        return [y, x]; // [lat, lng] for Leaflet\n                    })\n                    .filter(coord => coord !== null);\n                if (latLngs.length > 0) {\n                    parentLayer.current = L.polygon(latLngs, {\n                        color: \"lightblue\",\n                        weight: 2,\n                        fillColor: \"lightblue\",\n                        fillOpacity: 0.3,\n                        interactive: false,\n                    }).addTo(mapInstance.current);\n                    console.log(\"✅ Rendered parent zone shape in Leaflet:\", latLngs);\n                } else {\n                    console.warn(\"⚠️ No valid latLngs to render parent zone in Leaflet\");\n                }\n            } else {\n                console.log(\"ℹ️ No parent zone vertices to render in Leaflet\");\n            }\n        }\n\n        // Cleanup\n        return () => {\n            if (mapInstance.current) {\n                mapInstance.current.remove();\n                mapInstance.current = null;\n                console.log(\"🗺 Leaflet map cleaned up\");\n            }\n        };\n    }, [mapData, useLeaflet, onDrawComplete, triggerColor, drawnItems, parentZoneVertices]);\n\n    return (\n        <div>\n            {error && <div style={{ color: \"red\", marginBottom: \"10px\" }}>{error}</div>}\n            {useLeaflet ? (\n                <div ref={mapRef} style={{ height: \"600px\", width: \"800px\", border: \"2px solid black\" }} />\n            ) : (\n                <canvas ref={canvasRef} id=\"map\" style={{ border: \"2px solid black\" }} />\n            )}\n        </div>\n    );\n});\n\nexport default MapZoneBuilder;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}